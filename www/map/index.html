<!doctype html>
<html lang="en" id="greatname.se/marcus/maps/gps_map">
 <head>
  <meta charset="utf-8">
   <title>iPad style layout jQuery mobile with Google maps - Google maps jQuery plugin</title>
   <meta name="keywords" content="iPad style layout jQuery mobile Google maps, jQuery, plugin, mobile, iphone, ipad, android, HTML5">
   <meta name="description" content="iPad style layout examples with jQuery mobile, Google maps and HTML5, based on Google maps V3 plugin for jQuery by @johansall, jQuery UI and jQuery Mobile http://code.google.com/p/jquery-ui-map/">
   <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
   <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="translucent black">
   <meta name="author" content="greatname.se">
    <meta name="robots" content="all">
     <link rel="icon" href="m57.png">
      <link rel="apple-touch-icon" href="m57.png">
       <link rel="apple-touch-icon" sizes="72x72" href="m72.png">
       <link rel="apple-touch-icon" sizes="114x114" href="m114.png">
       <link href="http://fonts.googleapis.com/css?family=Open%20Sans&subset=latin" rel="stylesheet">
       <link rel="stylesheet" href="main-mobile2.css">
       <link rel="stylesheet" href="mobile-map.css"/>
       <script src="modernizr.min.js"></script>
       <script src="https://www.google.com/jsapi?"></script>
       <script>
        google.load('maps', '3.7', {
         other_params: 'sensor=false'
        });
        google.load('jquery', '1.7.1');
       </script>
        <script src="http://code.jquery.com/mobile/latest/jquery.mobile.min.js"></script>
       <script src="../../ui/min/jquery.ui.map.full.min.js"></script>
       <script src="../../ui/jquery.ui.map.extensions.js"></script>
       <script>
        var oncampus = false;
        var SCU_campus_region = {};
			SCU_campus_region.north_lat = 37.352588;
			SCU_campus_region.south_lat = 37.344415;
			SCU_campus_region.west_long = -121.946109;
			SCU_campus_region.east_long = -121.931895; 
        $('#gps_map').live("pageshow", function () {
         $('#map_canvas_2').gmap('refresh');
        });
        $('#gps_map').live("pagecreate", function () {
         $('#map_canvas_2').gmap({
          'center': '37.34942, -121.940178',
          'zoom': 18
         }).bind('init', function (event, map) {
          
          $('#map_canvas_2').gmap('watchPosition', function (position, status) {
           if (status === 'OK') {
           	if ( (position.coords.latitude <= SCU_campus_region.north_lat) && (position.coords.latitude >= SCU_campus_region.south_lat) && (position.coords.longitude <= SCU_campus_region.east_long) && (position.coords.longitude >= SCU_campus_region.west_long) ) {
           		oncampus = true
           		}
			var myLocIcon = new google.maps.MarkerImage('/map/pegman.png');
            var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
            var marker = $('#map_canvas_2').gmap('get', 'markers> client');
            if (!marker && oncampus) {
             $('#map_canvas_2').gmap('addMarker', {
              'id': 'client',
              'position': latlng,
              'icon': myLocIcon
             });
             map.panTo(latlng);
            } else {
             marker.setPosition(latlng);
             map.panTo(latlng);
            }
           }
          });
          
          var trafficOptions = {
			getTileUrl: function(coord, zoom) {
			return "http://cms.scu.edu/docs/gmaps/get_tile.cfm?" +"zoom=" + zoom + "&coords=" +coord;
			},
			tileSize: new google.maps.Size(256, 256),
			isPng: true
			};
		  var trafficMapType = new google.maps.ImageMapType(trafficOptions);
		  map.overlayMapTypes.insertAt(0, trafficMapType);
          
         });
        });
        $('#gps_map').live("pagehide", function () {
         $('#map_canvas_2').gmap('clearWatch');
        });
		$(function(){
	$('body').delegate('.content-secondary .ui-collapsible-content', 'click',  function(){
		$(this).trigger("collapse")
	});
});
function setDefaultTransition(){
	var winwidth = $( window ).width(),
		trans ="slide";
	if( winwidth >= 1000 ){
		trans = "none";
	}
	else if( winwidth >= 650 ){
		trans = "fade";
	}
	$.mobile.defaultPageTransition = trans;
}
$(function(){
	setDefaultTransition();
	$( window ).bind( "throttledresize", setDefaultTransition );
});
       </script>
      </head>
      <body>
       <div id="gps_map" data-role="page" class="type-interior" data-theme="g">
<!-- page -->
        <div data-role="header" data-theme="a">
<!-- header -->
         <h1>Geolocation</h1>
         <a href="index.html" rel="external" data-icon="home" data-iconpos="notext" class="ui-btn-right jqm-home">Home</a>
        </div>
<!-- /header -->
        <div data-role="content" class="content-secondary">
<!-- content-secondary -->
         <div data-role="collapsible" data-collapsed="true" data-content-theme="g">
<!-- nav-bar -->
          <h3>Menu</h3>
          <ul data-role="listview" data-inset="true" data-theme="c" data-dividertheme="a">
           <li data-theme="a"><a rel="external" href="#">Campus map</a></li>
           <li><a rel="external" href="locations.html">Locations</a></li>
           <li><a rel="external" href="directions.html">Get directions</a></li>
           <li><a rel="external" href="fusion.html">Fusion Tables</a></li>
          </ul>
         </div>
<!-- /nav-bar -->
        </div>
<!-- /content-secondary -->
        <div data-role="content" class="content-primary" style="padding:1em;height:100%;">
<!-- content-primary -->
         <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
          <div id="map_canvas_2"></div>
         </div>
        </div>
<!-- /content-primary -->
       </div>
<!-- /page -->
      </body>
     </html>