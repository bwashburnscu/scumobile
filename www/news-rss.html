<!DOCTYPE html> 
<html> 
	<head> 
	<title>News</title> 
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/jquery.mobile-1.3.2.min.css" />
	<link rel="stylesheet" href="assets/scu.css" />
	<link rel="stylesheet" href="assets/secondary.css" />
	<script src="assets/jquery-1.10.2.min.js"></script> 
	<script src="assets/jquery.mobile-1.3.2.min.js"></script>
	<link rel="stylesheet" href="assets/responsive-nav.css" />
    <script src="assets/responsive-nav.js"></script>
	
 	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">

    google.load("feeds", "1");
    
    var rssfeed = new Array();
	rssfeed[0] = "http://www.scu.edu/syn/blog226.xml";
	rssfeed[1] = "http://www.scu.edu/syn/blog93.xml";
	rssfeed[2] = "http://www.santaclarabroncos.com/video/winterOlympics?feed=rss_2.0";
	rssfeed[3] = "http://www.thesantaclara.com/se/the-santa-clara-rss-1.1833635";
	rssfeed[4] = "http://feeds.feedburner.com/SantaClaraLawNews";

    function initialize() {
      var feedid = getUrlVars()["feed"];
      var feed = new google.feeds.Feed(rssfeed[feedid]);
      feed.setNumEntries(10);
      feed.setResultFormat(google.feeds.Feed.MIXED_FORMAT);
      feed.load(function(result) {
        if (!result.error) {
          var container = document.getElementById("feed");
          var rssContent = "";
          var imgUrl = "";
          $("#subtitle").html(result.feed.title);
          for (var i = 0; i < result.feed.entries.length; i++) {
            var entry = result.feed.entries[i];
           // if (entry.xmlNode.getElementsByTagName("enclosure").length > 0) {
            	//imgUrl =  entry.xmlNode.getElementsByTagName("enclosure")[0].getAttribute("url");
            	//imgUrl = "<img src='" + imgUrl + "' />";
            	//} else {
            	//imgUrl = '';
            	//}
            //rssContent += "<div data-role='collapsible' data-theme='a'><h3>" + entry.title + "</h3><h4>" + entry.title + "</h4><h4>" + entry.publishedDate + "</h4><p>" + entry.contentSnippet + "</p><p><a href='" + entry.link + "'>Continue Reading &raquo;</a></p></div>";
            if(entry.link.indexOf('?c=') > 0) {
            	var cid = entry.link.split('?c=');
            	entry.link = 'news-blog.html?cid=' + cid[1];
            }
            rssContent += "<li><a rel='external' href='" + entry.link + "'>" + imgUrl + "<h3>" + entry.title + "</h3><p>" + entry.publishedDate + "</p></a></li>";
            }          
          container.innerHTML=rssContent;
        }
        $("#feed").listview("refresh");
      });
    }
    google.setOnLoadCallback(initialize);
    
    </script>
   
	</head> 
<body> 

<div data-role="page" class="type-interior" data-theme="a">
	<script>
	   
		function getUrlVars() {
		var vars = [], hash;
		var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
		for(var i = 0; i < hashes.length; i++)
		    {
		        hash = hashes[i].split('=');
		        vars.push(hash[0]);
		        vars[hash[0]] = hash[1];
		    }
		return vars;
		}
		
		function navmenu(n,m) {
		    $.ajax({
		     type: "GET",
		     url: 'http://m.scu.edu/nav/'+n+'.json',
		     dataType: 'json',
		     beforeSend: function(x) {
		      if(x && x.overrideMimeType) {
		       x.overrideMimeType("application/j-son;charset=UTF-8");
		      }
			 },
			 success: function(data){
			 	var output = '';
			    for (var i in data.menuitems) {
				    output += '<li><a href="' + data.menuitems[i].href + '"';
				    if(data.menuitems[1].rel == 'external'){
				    output += ' target="_blank"';
				    }
				    output += ' data-ajax="false"';
				    output += '>';
				    output += data.menuitems[i].label;
				    output += '</a></li>';
		        }
				$("#"+m).append(output).listview("refresh");
		     }
			});
		}
		

	</script>
	<div id="header">
		<a data-ajax="false" href="index.html" class="homenav"><img alt="" src="assets/38-house.png" /></a>
	</div><!-- /header -->

	<div data-role="content">
	    <div class="content-primary">
	    <div id="nav">
	      <ul id="tnews"></ul>
	    </div>
	    <script>
	    	navmenu('news','tnews');
	        var navigation = responsiveNav("#nav", {
	            animate: false,        // Boolean: Use CSS3 transitions, true or false
				insert: "before",      // String: Insert the toggle before or after the navigation
				openPos: "relative",  // String: Position of the opened nav, relative or static
				jsClass: "js"        // String: 'JS enabled' class which is added to <html> el
	      });
	    </script>
	    <h2 id="inews" class="pagetitle"><a href="news.html" data-ajax="false">SCU News</a></h2>
	    <div id="subtitle"></div>
		<ul data-role="listview" id="feed">
		</ul>
	</div>
	<div class="content-secondary">
		<ul id="mnews" data-role="listview" data-inset="true"></ul>
	    <script>
		    navmenu('news','mnews');
	    </script>
	</div>
	</div>
	

	
	<div data-role="footer" id="footer">
		<p style="text-align:center;">&copy; Santa Clara University</p>
	</div><!-- /footer -->
</div><!-- /page -->

</body>
</html>